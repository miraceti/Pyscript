<!-- Upload file to pyscript -->

<!DOCTYPE html>
<html lang="en-US">
<head>

    <title>Red Recipe</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <!--<link rel="stylesheet" href="https://pyscript.net/releases/2023.03.1/pyscript.css" />
    -->
    <script defer src="https://pyscript.net/releases/2023.03.1/pyscript.js"></script>
    <!--<script type="text/javascript" src="https://cdn.bokeh.org/bokeh/release/bokeh-3.1.1.js"></script>
    <script type="text/javascript" src="https://cdn.bokeh.org/bokeh/release/bokeh-widgets-3.1.1.min.js"></script>
    <script type="text/javascript" src="https://cdn.bokeh.org/bokeh/release/bokeh-tables-3.1.1.min.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@holoviz/panel@1.0.4/dist/panel.min.js"></script>
    <script type="text/javascript">  Bokeh.set_log_level("info"); </script>
    -->
    <!--<link rel="stylesheet" href="https://pyscript.net/alpha/pyscript.css" />
    -->
    <!--<script defer src="https://pyscript.net/alpha/pyscript.js"></script>
    -->
    <py-env>
        - numpy
        - pandas
        - panel==0.13.1a2
    </py-env>
    


</head>

<body>
    <py-config src="./pyscript.toml"></py-config>
    <h1>Upload csv</h1>
          
                <div id="fileinput"></div>
                <div id="upload"></div>
                <div id="table"></div>
            
        
    <py-script>
import asyncio
import panel as pn
import pandas as pd
from panel.io.pyodide import show

fileInput = pn.widgets.FileInput(accept='.csv')
uploadButton = pn.widgets.Button(name='Upload', button_type = 'primary')

table = pn.widgets.Tabulator(pagination='remote', page_size=10)

document.getElementById('table').style.display = 'none'

def process_file(event):
    if fileInput.value is not None:
        table.value = pd.read_csv(io.BytesIO(fileInput.value))
        document.getElementById('table').style.display = 'block'

uploadButton.on_click(process_file)
await micropip.install("pandas")
#await show(fileInput, 'fileinput')
#await show(uploadButton, 'upload')
#await show(table, 'table')
    </py-script>
</body>

</html>
